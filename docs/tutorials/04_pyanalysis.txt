
The Analysis module of Pandora allows the user to calculate basic statistics generated from the data stored during a simulation. This tutorial will define how to use it using the Python interface of the framework. These analysis generate a set of csv files (Comma Separated Values) that can be loaded from any spreadsheet application (like LibreOffice Calc), as well as from several statistical packages (like R).

We will generate a basic dataset, and will try to load it afterwards.
First of all let's create the simulation. Follow the tutorial (ENLLAÃ‡ GETTING STARTED PYPANDORA) and execute the simulation. It will create a folder called 'data' with the files 'gujarat.h5' and 'agents-0.abm' in it. These files contain the data from rasters and agents collected during each time step.

To analyse the data, we need to load it into an instance of the class SimulationRecord:

import sys
sys.path.append('..')
sys.path.append('../../')
from pyPandora import SimulationRecord,

record = SimulationRecord()
record.loadHDF5('data/results.h5', 1, 1)

These lines create a SimulationRecord and loads the file 'data/results.h5'. If the folder generated by the simulation is in another path please use it. 
The method loadHDF5 has three parameters.  The first one is the file to be loaded, and the other ones allows the user to specify if agents and rasters must be loaded (flag set to 1) or not (flag set to 0).

Once that data is loaded, we will create a set of tools to analyze the agents, as well as the values of the rasters. This is done using the classes AgentResults and RasterResults. The constructors of both of them need to specify the instance of SimulationRecord used, the output file, the agent type or raster to be analyzed and, finally, the separator:

agentResults = AgentResults(record, 'agents.csv', 'MyAgent', ';')
rasterResults = RasterResults(record, 'rasters.csv', 'resources', ';')

We will add several analysis to both of them. Each analysis is a different class, and has a different set of parameters, for example:
agentResults.addAnalysis(AgentNum())
agentResults.addAnalysis(AgentMean('x'))
agentResults.addAnalysis(AgentMean('y'))
agentResults.addAnalysis(AgentMean('resources'))
agentResults.addAnalysis(AgentSum('resources'))
agentResults.addAnalysis(AgentHDFtoSHP('shp/agents.shp', -1))

The first analysis stores the number of agents for each time step. The second, third and fourth one compute the mean of each variable amongst the entire set of agents. The fifth one calculates the sum of values, and finally the last analysis generate a georeferenced file (Shapefile http://www.esri.com/library/whitepapers/pdfs/shapefile.pdf) that can be loaded by any GIS software.

Regarding rasters, given the fact that each instance of RasterResults is defined for a raster, we can calculate the Mean and Sum of values:
rasterResults.addAnalysis(RasterMean())
rasterResults.addAnalysis(RasterSum())

Finally, we will need to add these classes in the import section:

from pyPandora import SimulationRecord, AgentResults, AgentMean, AgentSum, AgentNum, AgentHDFtoSHP, RasterMean, RasterSum, RasterResults

and compute results:

agentResults.compute()
rasterResults.compute()

